import org.springframework.boot.actuate.endpoint.SanitizableData;
import org.springframework.boot.actuate.endpoint.SanitizingFunction;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import java.util.regex.Pattern;

@Configuration
public class ActuatorSanitizerConfig {

    @Bean
    public SanitizingFunction passwordSanitizer() {
        // Regex pattern to match keys containing 'password', 'secret', or 'token'
        Pattern sensitivePattern = Pattern.compile(".*(password|secret|token).*", Pattern.CASE_INSENSITIVE);

        return (SanitizableData data) -> {
            if (sensitivePattern.matcher(data.getKey()).matches()) {
                return data.withValue("****");
            }
            return data;
        };
    }
}
